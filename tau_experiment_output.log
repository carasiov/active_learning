Output: /home/user/active_learning/experiments/runs/tau_classifier_validation_20251110_021136
Config saved: /home/user/active_learning/experiments/runs/tau_classifier_validation_20251110_021136/config.yaml
Loading MNIST: 5000 samples, 500 labeled...
  Train: 5000 (500 labeled)

============================================================
Training Model
============================================================
============================================================
 JAX Device: CPU (1 device) [JAX_PLATFORMS override]
============================================================

Training with τ-classifier (τ-based latent-only classification)
Monitoring validation classification_loss for early stopping.
Detected 500 labeled samples.
Training on CPU (1 device)
Epoch |   Train.loss |     Val.loss | Train.loss_np |  Val.loss_np |    Train.rec |      Val.rec |     Train.kl |       Val.kl |    Train.cls |      Val.cls |    Train.con |      Val.con
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    1 |     309.7436 |     311.1839 |     217.8650 |     219.3056 |     215.0180 |     216.4432 |       0.5533 |       0.5330 |       2.2937 |       2.3294 |       0.0000 |       0.0000
    2 |     291.7204 |     291.7959 |     199.8202 |     199.8963 |     195.9792 |     196.0189 |       1.5602 |       1.5571 |       2.2808 |       2.3203 |       0.0000 |       0.0000
    3 |     284.1416 |     284.3628 |     192.2238 |     192.4456 |     188.0069 |     188.2144 |       1.9870 |       1.9754 |       2.2299 |       2.2558 |       0.0000 |       0.0000
    4 |     277.3921 |     277.7640 |     185.4632 |     185.8358 |     180.6224 |     181.0057 |       2.6391 |       2.6000 |       2.2017 |       2.2301 |       0.0000 |       0.0000
    5 |     272.9925 |     274.0827 |     181.0688 |     182.1596 |     176.3094 |     177.3999 |       2.5892 |       2.5446 |       2.1702 |       2.2150 |       0.0000 |       0.0000
    6 |     270.4607 |     271.7092 |     178.5265 |     179.7757 |     173.6024 |     174.8502 |       2.7703 |       2.7284 |       2.1538 |       2.1971 |       0.0000 |       0.0000
    7 |     267.5216 |     269.4419 |     175.5966 |     177.5176 |     170.6720 |     172.5981 |       2.7845 |       2.7272 |       2.1402 |       2.1923 |       0.0000 |       0.0000
    8 |     264.7110 |     266.3880 |     172.7898 |     174.4674 |     167.7442 |     169.4156 |       2.9333 |       2.8783 |       2.1123 |       2.1734 |       0.0000 |       0.0000
    9 |     263.4040 |     265.3255 |     171.4858 |     173.4085 |     166.5318 |     168.4376 |       2.8560 |       2.7996 |       2.0981 |       2.1713 |       0.0000 |       0.0000
   10 |     261.6219 |     263.7207 |     169.7028 |     171.8030 |     164.5998 |     166.6772 |       3.0277 |       2.9643 |       2.0753 |       2.1615 |       0.0000 |       0.0000
   11 |     259.9146 |     262.0901 |     167.9991 |     170.1762 |     163.0619 |     165.2134 |       2.8601 |       2.8017 |       2.0771 |       2.1611 |       0.0000 |       0.0000
   12 |     258.4663 |     260.9024 |     166.5514 |     168.9892 |     161.3264 |     163.7542 |       3.1620 |       3.0829 |       2.0631 |       2.1521 |       0.0000 |       0.0000
   13 |     256.7729 |     259.6782 |     164.8486 |     167.7532 |     159.6136 |     162.5188 |       3.1627 |       3.0800 |       2.0723 |       2.1543 |       0.0000 |       0.0000
   14 |     254.6567 |     257.7936 |     162.7406 |     165.8766 |     157.4982 |     160.6432 |       3.1744 |       3.0944 |       2.0680 |       2.1391 |       0.0000 |       0.0000
   15 |     252.9926 |     256.3596 |     161.0824 |     164.4473 |     155.9581 |     159.3111 |       3.0846 |       2.9985 |       2.0397 |       2.1377 |       0.0000 |       0.0000
   16 |     250.0925 |     254.0272 |     158.1681 |     162.1002 |     153.0383 |     156.9707 |       3.0842 |       2.9957 |       2.0455 |       2.1337 |       0.0000 |       0.0000
   17 |     247.3660 |     251.4415 |     155.4350 |     159.5070 |     150.2912 |     154.3811 |       3.1361 |       3.0303 |       2.0077 |       2.0955 |       0.0000 |       0.0000
   18 |     245.7401 |     250.7466 |     153.8088 |     158.8108 |     148.5106 |     153.5163 |       3.3227 |       3.2064 |       1.9755 |       2.0880 |       0.0000 |       0.0000
   19 |     243.7866 |     248.6915 |     151.8547 |     156.7551 |     146.6006 |     151.5157 |       3.2818 |       3.1648 |       1.9724 |       2.0746 |       0.0000 |       0.0000
   20 |     242.1966 |     247.0969 |     150.2653 |     155.1609 |     144.9389 |     149.8528 |       3.3502 |       3.2238 |       1.9763 |       2.0843 |       0.0000 |       0.0000
   21 |     241.8409 |     247.0103 |     149.9126 |     155.0772 |     144.7782 |     149.9481 |       3.1805 |       3.0541 |       1.9540 |       2.0749 |       0.0000 |       0.0000
   22 |     240.4252 |     246.2529 |     148.4953 |     154.3191 |     143.1990 |     149.0303 |       3.3385 |       3.2160 |       1.9579 |       2.0729 |       0.0000 |       0.0000
   23 |     240.7419 |     246.1981 |     148.8132 |     154.2662 |     143.6380 |     149.0856 |       3.2453 |       3.1253 |       1.9300 |       2.0553 |       0.0000 |       0.0000
   24 |     239.1144 |     245.2473 |     147.1845 |     153.3142 |     141.9557 |     148.1035 |       3.2981 |       3.1654 |       1.9307 |       2.0453 |       0.0000 |       0.0000
   25 |     238.4512 |     244.8653 |     146.5202 |     152.9312 |     141.2300 |     147.6674 |       3.3557 |       3.2124 |       1.9345 |       2.0514 |       0.0000 |       0.0000
   26 |     237.2795 |     244.0583 |     145.3474 |     152.1223 |     140.0757 |     146.8649 |       3.3533 |       3.2147 |       1.9184 |       2.0426 |       0.0000 |       0.0000
   27 |     236.3936 |     243.6084 |     144.4629 |     151.6746 |     139.1893 |     146.4402 |       3.3519 |       3.2046 |       1.9217 |       2.0297 |       0.0000 |       0.0000
   28 |     235.8756 |     243.0194 |     143.9460 |     151.0879 |     138.6693 |     145.8520 |       3.3827 |       3.2391 |       1.8940 |       1.9969 |       0.0000 |       0.0000
   29 |     235.8015 |     243.2929 |     143.8716 |     151.3616 |     138.7071 |     146.2387 |       3.2615 |       3.1146 |       1.9031 |       2.0083 |       0.0000 |       0.0000
   30 |     235.1442 |     243.1788 |     143.2123 |     151.2438 |     137.9108 |     145.9886 |       3.3899 |       3.2429 |       1.9117 |       2.0123 |       0.0000 |       0.0000
   31 |     234.1472 |     243.0087 |     142.2150 |     151.0727 |     136.9721 |     145.8698 |       3.3497 |       3.1939 |       1.8932 |       2.0090 |       0.0000 |       0.0000
   32 |     234.6343 |     243.7117 |     142.7009 |     151.7746 |     137.4826 |     146.6009 |       3.3173 |       3.1638 |       1.9009 |       2.0100 |       0.0000 |       0.0000
   33 |     233.7548 |     242.3213 |     141.8228 |     150.3860 |     136.5448 |     145.1498 |       3.4002 |       3.2434 |       1.8778 |       1.9927 |       0.0000 |       0.0000
   34 |     233.4863 |     243.2373 |     141.5534 |     151.3004 |     136.3456 |     146.1218 |       3.3384 |       3.1784 |       1.8693 |       2.0002 |       0.0000 |       0.0000
   35 |     232.4630 |     242.3743 |     140.5307 |     150.4382 |     135.2564 |     145.2047 |       3.4086 |       3.2505 |       1.8658 |       1.9830 |       0.0000 |       0.0000
   36 |     232.3572 |     242.2288 |     140.4265 |     150.2945 |     135.0814 |     144.9895 |       3.4906 |       3.3262 |       1.8544 |       1.9789 |       0.0000 |       0.0000
   37 |     232.3373 |     241.9978 |     140.4058 |     150.0622 |     135.2828 |     144.9840 |       3.2711 |       3.1149 |       1.8519 |       1.9632 |       0.0000 |       0.0000
   38 |     231.6687 |     242.0367 |     139.7377 |     150.1020 |     134.3318 |     144.7642 |       3.5562 |       3.3831 |       1.8498 |       1.9547 |       0.0000 |       0.0000
   39 |     232.5567 |     243.3616 |     140.6251 |     151.4258 |     135.2971 |     146.1364 |       3.4822 |       3.3190 |       1.8458 |       1.9704 |       0.0000 |       0.0000
   40 |     231.7528 |     242.0414 |     139.8225 |     150.1078 |     134.5594 |     144.9011 |       3.4072 |       3.2471 |       1.8559 |       1.9596 |       0.0000 |       0.0000
   41 |     230.5241 |     242.0319 |     138.5949 |     150.0990 |     133.3475 |     144.8857 |       3.4144 |       3.2514 |       1.8330 |       1.9619 |       0.0000 |       0.0000
   42 |     230.7793 |     242.1260 |     138.8478 |     150.1901 |     133.7058 |     145.0840 |       3.3115 |       3.1556 |       1.8305 |       1.9505 |       0.0000 |       0.0000
   43 |     230.8601 |     242.3337 |     138.9291 |     150.3992 |     133.6798 |     145.2037 |       3.4130 |       3.2524 |       1.8363 |       1.9431 |       0.0000 |       0.0000
   44 |     230.1645 |     242.2526 |     138.2357 |     150.3201 |     133.0589 |     145.1885 |       3.3442 |       3.1792 |       1.8325 |       1.9524 |       0.0000 |       0.0000
   45 |     230.2389 |     242.1201 |     138.3106 |     150.1891 |     132.9909 |     144.9347 |       3.4888 |       3.3186 |       1.8309 |       1.9358 |       0.0000 |       0.0000
   46 |     230.0811 |     243.0005 |     138.1532 |     151.0683 |     132.9866 |     145.9171 |       3.3522 |       3.1870 |       1.8144 |       1.9642 |       0.0000 |       0.0000
   47 |     229.6102 |     241.7082 |     137.6834 |     149.7787 |     132.3813 |     144.5524 |       3.4788 |       3.3006 |       1.8233 |       1.9257 |       0.0000 |       0.0000
   48 |     230.3806 |     242.4726 |     138.4529 |     150.5404 |     133.2556 |     145.3656 |       3.3853 |       3.2185 |       1.8120 |       1.9564 |       0.0000 |       0.0000
   49 |     229.2644 |     241.6926 |     137.3396 |     149.7653 |     132.0404 |     144.5170 |       3.4842 |       3.3084 |       1.8150 |       1.9399 |       0.0000 |       0.0000
   50 |     229.5549 |     240.8961 |     137.6322 |     148.9711 |     132.3132 |     143.7097 |       3.5028 |       3.3354 |       1.8162 |       1.9260 |       0.0000 |       0.0000
Training complete. Best classification_loss = 1.9257 (checkpoint saved to /home/user/active_learning/experiments/runs/tau_classifier_validation_20251110_021136/checkpoint.ckpt).
Mixture history saved to /home/user/active_learning/experiments/runs/tau_classifier_validation_20251110_021136/diagnostics/checkpoint (50 epochs tracked)
Training complete in 306.6s

Generating visualizations...
  Saved: /home/user/active_learning/experiments/runs/tau_classifier_validation_20251110_021136/loss_comparison.png
  Saved: /home/user/active_learning/experiments/runs/tau_classifier_validation_20251110_021136/latent_spaces.png
  Saved: /home/user/active_learning/experiments/runs/tau_classifier_validation_20251110_021136/latent_by_component.png
  Saved: /home/user/active_learning/experiments/runs/tau_classifier_validation_20251110_021136/responsibility_histogram.png
  Saved: /home/user/active_learning/experiments/runs/tau_classifier_validation_20251110_021136/visualizations/mixture/model_evolution.png
  Saved: /home/user/active_learning/experiments/runs/tau_classifier_validation_20251110_021136/model_reconstructions.png
  Model: Component embedding stats:
    K=10, embed_dim=8
    Distance: mean=0.506, std=0.198, min=0.109, max=0.912
  Saved: /home/user/active_learning/experiments/runs/tau_classifier_validation_20251110_021136/component_embedding_divergence.png
  Saved: /home/user/active_learning/experiments/runs/tau_classifier_validation_20251110_021136/model_reconstruction_by_component.png
  Model: τ matrix shape=(10, 10), sparsity=0.250, avg_comp/label=1.20
  Saved: /home/user/active_learning/experiments/runs/tau_classifier_validation_20251110_021136/tau_matrix_heatmap.png
  Model: Overall accuracy = 31.8%
  Saved: /home/user/active_learning/experiments/runs/tau_classifier_validation_20251110_021136/tau_per_class_accuracy.png
  Model: Certainty range=[0.067, 0.755], mean=0.251
  Saved: /home/user/active_learning/experiments/runs/tau_classifier_validation_20251110_021136/tau_certainty_analysis.png
  Saved: /home/user/active_learning/experiments/runs/tau_classifier_validation_20251110_021136/summary.json
  Saved: /home/user/active_learning/experiments/runs/tau_classifier_validation_20251110_021136/REPORT.md

============================================================
Experiment complete! Results: /home/user/active_learning/experiments/runs/tau_classifier_validation_20251110_021136
============================================================

