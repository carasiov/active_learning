# Claude Code Customization Tasks

> **Purpose:** Spec for parallel session to implement Claude Code customizations.
> **Coordinator session:** Maintains workflow context, evaluates results.
> **This session:** Implements and tests.

---

## Context

This project uses a three-tier agent model (see `docs/workflow/README.md`):
- **High-level**: ChatGPT (conceptual/math synthesis)
- **Intermediate**: Claude Code (coordination, experiments, verification)
- **Low-level**: Implementation execution

Key friction point: When intermediate needs to escalate to high-level, user must manually relay. We want to standardize this handoff.

---

## Task 1: Create `/relay-highlevel` Slash Command

**Location:** `.claude/commands/relay-highlevel.md`

**Purpose:** Generate a structured packet for user to copy-paste to the high-level agent (ChatGPT).

**When to use:** When intermediate agent needs conceptual/mathematical direction and must escalate.

**Protocol (from `docs/workflow/README.md`):**

The packet must include:
1. **Current factorization** — what are the random variables, conditioning structure
2. **Exact objective** — ELBO terms, losses, weights, schedules
3. **What "component" means** — mixture component, decoder channel, etc.
4. **How labels influence training** — where supervision enters
5. **Concrete symptom or decision point** — what's broken or needs deciding

**Command behavior:**
1. Ask user (or accept as argument): "What is the concrete symptom or question?"
2. Read current project's CONTEXT.md for factorization/objective/component definitions
3. Generate structured markdown packet with all 5 elements
4. Output should be copy-paste ready for ChatGPT

**Output format:**
```markdown
## Relay to High-Level Agent

### Current Factorization
[from CONTEXT.md or codebase verification]

### Objective Structure
[ELBO terms, losses, weights]

### Component Definition
[what a "component" means in this system]

### Label Integration
[how supervision enters]

### Symptom / Question
[user-provided or current issue]

---
*Generated by /relay-highlevel from [project context]*
```

**Acceptance criteria:**
- [ ] Command exists at `.claude/commands/relay-highlevel.md`
- [ ] Running `/relay-highlevel` produces structured output
- [ ] Output follows the 5-element protocol
- [ ] Output is concise and copy-paste ready

---

## Task 2: Create `/session-capture` Slash Command

**Status:** Ready to implement (Task 1 complete).

**Location:** `.claude/commands/session-capture.md`

**Purpose:** Generate SESSION_*.md file before /clear, capturing session state for future bootstrap.

**When to use:** End of session, before running /clear, when you want to preserve context.

**Reference:** See `docs/workflow/SESSION_2025-12-22.md` for example format.

**Command behavior:**
1. Ask user (or accept as argument): "What was the main focus this session?"
2. Use git to find files modified this session (git status, git diff --name-only)
3. Generate structured SESSION file with:
   - What was accomplished (user input + inferred from changes)
   - Key decisions made
   - Files modified/created
   - Current state
   - Next steps / priorities
   - Restart command for next session
4. Write to `docs/workflow/SESSION_<YYYY-MM-DD>.md`
5. If file exists for today, append session number (SESSION_2025-12-22_2.md)

**Output format:**
```markdown
# Session Summary: YYYY-MM-DD

> **Purpose:** Capture session state for "Document & Clear" restart.
> **Delete after:** Next session successfully bootstraps from this.

---

## What Was Accomplished

[Bullet points of accomplishments]

## Key Decisions Made

[Numbered list of decisions]

## Files Modified This Session

```
Created:
  [list]

Modified:
  [list]
```

## Current State

[Brief description of where things stand]

## Next Steps

[Ordered priorities for next session]

---

## Restart Command

After `/clear`, tell the new session:

```
Read these files to bootstrap:
1. docs/workflow/README.md (your role)
2. docs/workflow/SESSION_<date>.md (what happened)
3. [current project CONTEXT.md if applicable]
```
```

**Acceptance criteria:**
- [ ] Command exists at `.claude/commands/session-capture.md`
- [ ] Running `/session-capture` produces SESSION file
- [ ] File is written to `docs/workflow/`
- [ ] Format matches the template above
- [ ] Git changes are detected and listed

---

## Task 3: Evaluate Subagent Need (Defer)

**Status:** After testing slash commands, evaluate if we need:
- `verify-codebase` subagent for "does code do X?" questions
- `analyze-experiment` subagent for result diagnosis

Only add if context bloat becomes a problem.

---

## How to Report Back

After implementing Task 1, tell the coordinator session:
1. What was created (file path, content summary)
2. Test result (did `/relay-highlevel` work?)
3. What felt awkward or needs iteration

---

## Reference Files

- Three-tier model: `docs/workflow/README.md`
- Project context: `docs/projects/decentralized_latents/channel_curriculum/CONTEXT.md`
- Claude Code customization surfaces: CLAUDE.md, `.claude/commands/`, `.claude/agents/`, `.claude/skills/`
