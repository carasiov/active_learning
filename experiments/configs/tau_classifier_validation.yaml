# τ-Classifier Validation Experiment
# Purpose: Validate τ-based latent-only classification with component-aware decoder
# Expected: Classification accuracy should recover from -18% drop

experiment:
  name: "tau_classifier_validation"
  description: "Validate τ-classifier with component-aware decoder (recovery experiment)"
  tags: ["tau", "component-aware", "validation"]
  date: "2025-11-10"

data:
  dataset: "mnist"
  num_samples: 5000
  num_labeled: 100  # Sufficient for meaningful τ statistics
  seed: 42

model:
  # Prior configuration
  prior_type: "mixture"
  num_components: 10

  # Architecture
  latent_dim: 2  # For visualization
  hidden_dims: [256, 128, 64]
  encoder_type: "dense"
  decoder_type: "dense"

  # Component-aware decoder (validated in previous experiment)
  use_component_aware_decoder: true
  component_embedding_dim: 8

  # τ-Classifier (NEW - this is what we're testing)
  use_tau_classifier: true
  tau_smoothing_alpha: 1.0

  # Regularization (validated settings from previous experiments)
  component_diversity_weight: -0.05  # NEGATIVE = reward diversity
  dirichlet_alpha: 5.0
  kl_c_weight: 0.001

training:
  batch_size: 128
  learning_rate: 0.001
  max_epochs: 50
  patience: 15

  # Loss weights
  recon_weight: 1.0
  kl_weight: 1.0
  label_weight: 1.0  # Classification weight

  # Annealing
  kl_c_anneal_epochs: 0  # No annealing needed for this experiment

callbacks:
  - logging
  - plotting
  - mixture_tracking

output:
  checkpoint: true
  visualizations: true
  diagnostics: true

metrics_to_track:
  - accuracy
  - reconstruction_loss
  - kl_loss
  - component_usage
  - tau_matrix_statistics
  - component_label_alignment
